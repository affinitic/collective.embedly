*** Settings ***

Library  Selenium2Library  timeout=15  implicit_wait=1

Resource  plone/act/keywords.txt

Variables  plone/app/testing/interfaces.py

Suite Setup  Open browser  ${front-page}

Suite Teardown  Close All Browsers


*** Variables ***

${front-page}  http://localhost:55001/plone/
${test-folder}  http://localhost:55001/plone/acceptance-test-folder
${install_form}  http://localhost:55001/plone/prefs_install_products_form

${PORT} =  55001
${ZOPE_URL} =  http://localhost:${PORT}
${PLONE_URL} =  ${ZOPE_URL}/plone
${BROWSER} =  Firefox


*** Test Cases ***

Test Create Page without Embedly
    Log in as site owner
    Go to  ${front-page}
    Add page  Without Embedly Page
    Click Edit In Edit Bar
    Wait Until Page Contains Element  dom=document.getElementById('text_ifr')
    Execute JavaScript  document.getElementById('text_ifr').contentDocument.body.innerHTML='<a class="external-link" href="http://www.youtube.com/watch?v=LBDtqdOG4Uc">Demo Video file from YouTube.</a>'
    Click button  name=form.button.save
    Page Should Contain  Demo Video file from YouTube.
    Logout

Test Create Page with Embedly
    Log in as site owner
    Go to  ${install_form}
    Select Checkbox  id=collective.embedly
    Click Button  Activate
    Go to  ${front-page}
    Add page  With Embedly Page
    Click Edit In Edit Bar
    Wait Until Page Contains Element  dom=document.getElementById('text_ifr')
    Execute JavaScript  document.getElementById('text_ifr').contentDocument.body.innerHTML='<a class="embedlylink external-link" href="http://www.youtube.com/watch?v=LBDtqdOG4Uc">Demo Video file from YouTube.</a>'
    Click button  name=form.button.save
    Page Should Not Contain  Demo Video file from YouTube.
    Page Should Contain Element  css=div.embed
    Logout

